<html>
  <head>
    <style>
      #map {
        width: 100%;
        height: 75%;
      }
    </style>
    <script src="https://maps.googleapis.com/maps/api/js"></script>
    <script type = "text/javascript">
			var map;
			var markers = new Array();
			var infoWindows = new Array();
			function initialize() {
        var mapCanvas = document.getElementById('map');
        var mapOptions = {
          center: new google.maps.LatLng(42.390921, -72.525994),
          zoom: 16,
          mapTypeId: google.maps.MapTypeId.HYBRID
        }
        map = new google.maps.Map(mapCanvas, mapOptions);
				
				var founds = <%- JSON.stringify(founds) %>;
				console.log(founds);
				
				for(var k = 0; k<founds.length; k++)
				{
					var date = new Date(founds[k].foundDate);
					

					if(!founds[k].retreived && Date.now()-date.getTime()<1000*60*60*24*21)
					{
						markers[k] = new google.maps.Marker({
							position: new google.maps.LatLng(founds[k].foundLocation.lat, founds[k].foundLocation.lng),
							map: map,
							title: founds[k].title
						});

						infoWindows[k] = new google.maps.InfoWindow({
							content: 'Title: '+founds[k].title +'<br>Category: '+founds[k].category +'<br>Date: '+founds[k].foundDate+'<br>Pick Up: '+founds[k].pickupDetails
						});
						
						google.maps.event.addListener(markers[k],'click',function() {
							console.log(k);
							console.log(typeof(infoWindows));
  						infoWindows[k].open(map,markers[k]);
  					});
					}
				}
      }
			

			

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="map"></div>

    <div>
      <form id="lostSearch" method="post" action="/lost">
        Search<input type="text" name="search"></input>
        Select by:<input type="text" name="category"></input>
        <!-- <select name="selection">
      <option value="category">
        Category
      </option>
    </select> -->
    </input>

        <input type="submit"></input>
      </form>
    </div>
  </body>
</html>
